name: metamesh

services:
  metamesh:
    image: pierreh37/meta-mesh:latest
    container_name: metamesh
    restart: unless-stopped
    cpu_shares: 20

    # Expose nginx router port for web UI and API access
    expose:
      - 80

    devices:
      # FUSE capabilities required for virtual filesystem
      - /dev/fuse:/dev/fuse
      # Hardware acceleration access
      - /dev/dri:/dev/dri

    group_add:
      - video

    cap_add:
      - SYS_ADMIN
      - SETPCAP
      - DAC_READ_SEARCH
      - DAC_OVERRIDE
      - CHOWN
      - FOWNER
      - SETUID
      - SETGID
    security_opt:
      - apparmor:unconfined

    # Volume bindings
    volumes:
      # Watch folders - Mount your media directories in watch
      - /DATA/Downloads:/data/watch/downloads:ro
      - /DATA/Media:/data/watch/media:ro

      # FUSE virtual filesystem mount (view-only organized view)
      - /DATA/MetaMesh/Library:/mnt/virtual:shared

      # Application data storage
      - /DATA/AppData/MetaMesh/hash-cache/:/data/index
      - /DATA/AppData/MetaMesh/database/:/data/etcd

    # Environment variables
    environment:
      - BASE_URL=https://metamesh-$PCS_DOMAIN
      - TMDB_API_KEY=
      - PUID=$PUID
      - PGID=$PGID
      - TZ=$TZ

    # Note: MetaMesh must run as root due to nginx, etcd, and FUSE.
    # The entrypoint script uses PUID/PGID for file ownership management.
    user: 0:0

x-casaos:
  architectures:
    - amd64
    - arm64
  author: Worph Team
  category: Media
  developer: Aptero Team

  description:
    en_us: |
      **Automatically organize your massive media library without moving a single file.**

      MetaMesh creates a beautifully organized virtual view of your media (Movies, TV Shows, Anime) while your actual files stay exactly where they are. No duplication, no disk space wasted.

      **Key Features:**
      • **Zero File Movement** - Your files stay in place, MetaMesh creates an organized virtual view
      • **Smart Metadata Extraction** - Automatically extracts titles, seasons, episodes, quality, language from filenames and FFmpeg analysis
      • **Duplicate Detection** - Finds exact duplicates and different quality versions of the same content
      • **Real-time Monitoring** - Watches folders and instantly processes new files
      • **WebDAV Network Access** - Access your organized library as a network drive from any device
      • **Built for Scale** - Handles collections up to 900k+ files and 100TB+ with optimized performance
      • **Distributed Storage** - Uses etcd for reliable, distributed metadata storage

      **Perfect for:** Media hoarders, Plex/Jellyfin users, content archivists, or anyone drowning in unorganized media files across multiple folders and drives.

      **What you get:** Monitoring dashboard, WebDAV file access, virtual filesystem, duplicate detection, metadata management, and remote storage integration (rclone).

    fr_fr: |
      **Organisez automatiquement votre immense bibliothèque multimédia sans déplacer un seul fichier.**

      MetaMesh crée une vue virtuelle magnifiquement organisée de vos médias (Films, Séries TV, Anime) pendant que vos fichiers restent exactement où ils sont. Pas de duplication, pas d'espace disque gaspillé.

      **Fonctionnalités Clés:**
      • **Zéro Déplacement de Fichiers** - Vos fichiers restent en place, MetaMesh crée une vue virtuelle organisée
      • **Extraction Intelligente de Métadonnées** - Extrait automatiquement titres, saisons, épisodes, qualité, langue des noms de fichiers et analyse FFmpeg
      • **Détection de Doublons** - Trouve les doublons exacts et différentes versions de qualité du même contenu
      • **Surveillance Temps Réel** - Surveille les dossiers et traite instantanément les nouveaux fichiers
      • **Accès Réseau WebDAV** - Accédez à votre bibliothèque organisée comme un lecteur réseau depuis n'importe quel appareil
      • **Conçu pour l'Échelle** - Gère des collections jusqu'à 900k+ fichiers et 100TB+ avec performances optimisées
      • **Stockage Distribué** - Utilise etcd pour un stockage de métadonnées fiable et distribué

      **Parfait pour:** Les collectionneurs de médias, utilisateurs Plex/Jellyfin, archivistes de contenu, ou toute personne noyée dans des fichiers médias non organisés sur plusieurs dossiers et disques.

  tagline:
    en_us: Organize massive media libraries without moving files - Smart virtual filesystem for Movies, TV & Anime
    fr_fr: Organisez d'immenses bibliothèques multimédia sans déplacer de fichiers - Système virtuel intelligent

  title:
    en_us: MetaMesh

  icon: https://cdn.jsdelivr.net/gh/Worph/AppStore@main/Apps/MetaMesh/icon.png
  screenshot_link:
    - https://cdn.jsdelivr.net/gh/Worph/AppStore@main/Apps/MetaMesh/screenshot-1.png
    - https://cdn.jsdelivr.net/gh/Worph/AppStore@main/Apps/MetaMesh/screenshot-2.png
    - https://cdn.jsdelivr.net/gh/Worph/AppStore@main/Apps/MetaMesh/screenshot-3.png
  thumbnail: https://cdn.jsdelivr.net/gh/Worph/AppStore@main/Apps/MetaMesh/thumbnail.png

  index: /
  store_app_id: metamesh
  main: metamesh
  is_uncontrolled: false
  webui_port: 80